<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Playlist</title>
</head>
<body>
    <h1>PlayList</h1>
        <% data.forEach(element => { %> 
            <div id=<%=`${element.imdbID}`%> class="card" style="width: 11rem;">
                 <!-- element.Poster  -->
                 <img  id="poster" src=<%=`${element.Poster}`%> class="card-img-top" alt="..."> 
            <div class="card-body">
                <p  id="imdb_id" class="card-text"><%= element.imdbID %> </p>
                <h5  id="title" class="card-title"><%= element.Title %> </h5>
              <p id="year" class="card-text"><%= element.Year %> </p>
            </div>
            <h1>
                <button id="submit_id" type="submit" value=<%=`${element.imdbID}`%>>Submit</button>
            </h1>
        </div> 
        <% }) %>

        <script>


            let submit_id = document.getElementById('submit_id').value;
            // add movie to playlist 
            console.log( document.getElementById(`${submit_id}`));

            document.getElementById('submit_id').addEventListener(('click') , async function(e){
                e.preventDefault();
                console.log(e);
                console.log(document.getElementById(`${submit_id}`));
                let movie_id = document.getElementById('imdb_id').value;
                let movie_title = document.getElementById('title').value;
                let movie_poster = document.getElementById('poster').value;
                let movie_year = document.getElementById('year').value;
                let isPublic = true;

                // send data to backend 
                console.log(movie_title);

    //             const response = await fetch("/api/playlist", {
    //       method: "POST",

    //       body:JSON.stringify({
    //         "Movie_id" : movie_id,
    //         "movie_title" : movie_title,
    //         "movie_year" :movie_year,
    //         "movie_poster" : movie_poster, 
    //         "isPublic" : isPublic
    //       }),
    //       headers: {
    //     "Content-type": "application/json; charset=UTF-8"
    // }
    //     });

    //     response.json().then((data) => {
    //       console.log(data);
    //       if(data.status === 'false'){
    //         //
    //         alert('Something went wrong')
    //       }else{
    //         alert('Movie added successfully !!!')
    //     //   window.location.href = `http://localhost:8080/api/home_redirect/${data.user.username}`;
    //       }
    //     });
            })
            
            
            
        </script>
    
    
</body>
</html>